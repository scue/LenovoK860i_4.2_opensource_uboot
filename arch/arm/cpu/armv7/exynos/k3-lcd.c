/* linux/drivers/video/samsung/s3cfb_dummymipilcd.c
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 *
 * Modified by Samsung Electronics (UK) on May 2010
 *
 */

#include <malloc.h>
#include <linux/list.h>
#include <linux/ctype.h>
#include <linux/err.h>
#include <linux/mtd/compat.h>
#include "regs-dsim.h"
#include "dsim.h"
#include "mipi_ddi.h"
#include "s5p-dsim.h"
#include "s3cfb.h"
#include <asm/io.h>
#include <asm/arch/pmic.h>

#define LCD_CE_INTERFACE
#ifdef LCD_CE_INTERFACE
static int ce_mode = 1;
#endif
#define printk printf
#define mdelay(n) udelay(n*1000)
extern int lcd_id;
extern int gpio_lcd;
static struct mipi_ddi_platform_data *ddi_pd;
static int g_no_lcd_connected = 0;	//used in factory mode without lcd connected

void otm1280a_write_0(unsigned char dcs_cmd)
{
	ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_NO_PARA, dcs_cmd, 0);
}

static void otm1280a_write_1(unsigned char dcs_cmd, unsigned char param1)
{
	ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, dcs_cmd, param1);
}

static void otm1280a_write_3(unsigned char dcs_cmd, unsigned char param1, unsigned char param2, unsigned char param3)
{
	unsigned char buf[4];
	buf[0] = dcs_cmd;
	buf[1] = param1;
	buf[2] = param2;
	buf[3] = param3;

	ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, 4);
}

static void otm1280a_write(void)
{
	unsigned char buf[15] = {0xf8, 0x01, 0x27, 0x27, 0x07, 0x07, 0x54,
		0x9f, 0x63, 0x86, 0x1a,
		0x33, 0x0d, 0x00, 0x00};
	ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
}

static void otm1280a_display_off(void)
{
	if(g_no_lcd_connected)
		return;
	ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, 0x28, 0x00);
}

void otm1280a_sleep_in(void)
{
	if(g_no_lcd_connected)
		return;
	ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_NO_PARA, 0x10, 0);
}

void otm1280a_sleep_out(void)
{
	if(g_no_lcd_connected)
		return;
	ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_NO_PARA, 0x11, 0);
}

static void otm1280a_display_on(void)
{         
	int ret;
	printf("##%s ##\n", __func__);
	if(g_no_lcd_connected)
		return;
	
	if (lcd_id == LCD_LG) {
#if 0 
		ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, 0x51, current_brightness);
		ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, 0x53, 0x24);
#else

		otm1280a_write_1(0xc2, 0x02);
		mdelay(15);
		otm1280a_write_1(0xc2, 0x06);
		mdelay(15);
		otm1280a_write_1(0xc2, 0x4E);
		mdelay(90);
		otm1280a_write_0(0x11);
		mdelay(20);
		do{
			unsigned char buf[] = {0xF9,0x80,0x00};
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
		}while(0);
		mdelay(15);
		otm1280a_write_0(0x29);
		mdelay(10);
		ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, 0x51, 0x30);
		ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, 0x53, 0x24);
#endif
	} else if (lcd_id == LCD_BOE) {
		ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, 0x51, 0x30);
		ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, 0x53, 0x24);
	}else if (lcd_id == LCD_NOVA_YASSY) {
		printf("cmmd_write 0x11\n");
		otm1280a_write_0(0x11);
		mdelay(20);
		printf("cmmd_write 0x29\n");
		otm1280a_write_0(0x29);
		mdelay(10);
		ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, 0x51, 0xff);
		ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, 0x53, 0x24);
	} else if (lcd_id == LCD_NOVA_CMI) {
		printf("cmmd_write 0x11\n");
		otm1280a_write_0(0x11);
		mdelay(20);
		printf("cmmd_write 0x29\n");
		otm1280a_write_0(0x29);
		mdelay(10);
		ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, 0x51, 0xff);
		ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_WR_1_PARA, 0x53, 0x24);
	}

}

void lcd_reset(void)
{
	u8 read_data;
	IIC0_ERead(0x12, 0x47, &read_data);
	IIC0_EWrite(0x12, 0x47,  (read_data | (0x3 << 6)));

	if (gpio_lcd == 0) {	//boe or cmi
		printf("lcd reset for BOE or CMI\n");
		writel((readl(0x11400188) & (~(0x3 <<0))), 0x11400188);//GPF0-0
		writel((readl(0x11400180) & (~(0xf <<0)))|(0x1 <<0), 0x11400180);

		writel((readl(0x11400184) & (~(0x1 <<0)))|(0x1 <<0), 0x11400184);//output 1
		mdelay(50);   

		writel((readl(0x11400184) & (~(0x1 <<0))), 0x11400184);//output 0
		mdelay(50);               

		writel((readl(0x11400184) & (~(0x1 <<0)))|(0x1 <<0), 0x11400184);//output 1
		mdelay(50);    
	} else {
		printf("lcd reset for LG or YASSY\n");
		writel((readl(0x11400188) & (~(0x3 <<0))), 0x11400188);//GPF0-0
		writel((readl(0x11400180) & (~(0xf <<0)))|(0x1 <<0), 0x11400180);

		writel((readl(0x11400184) & (~(0x1 <<0)))|(0x1 <<0), 0x11400184);//output 1
		mdelay(100);   

		writel((readl(0x11400184) & (~(0x1 <<0))), 0x11400184);//output 0
		mdelay(100);               

		writel((readl(0x11400184) & (~(0x1 <<0)))|(0x1 <<0), 0x11400184);//output 1
		mdelay(100);    

	}
}
static int lcd_init_cmd_write(unsigned int dsim_base, unsigned int data_id, unsigned char * buf, unsigned int size)
{
	int ret = DSIM_FALSE;
	u32 read_buf[100];

	memset(read_buf, 0, sizeof(read_buf));
	ret = ddi_pd->cmd_write(ddi_pd->dsim_base, data_id,  (unsigned int )buf, size);
	if (ret == 0){
		printf("cmmd_write error\n");
		return DSIM_FALSE;
	}

	return DSIM_TRUE;

}
#ifdef LCD_CE_INTERFACE
static int ce_on_off(int value)
{
	int ret;
	if(g_no_lcd_connected)
		return;
	if (lcd_id == LCD_LG) {
		if (value) {
			printk("%s: CE on for LG.\n", __func__);
#if 1
			//otm1280a_write_1(0x70, 0x00);
#if 1
			do{
				unsigned char buf[] = {0x74,0x05,0x03, 0x85};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);
#endif

			do{
				unsigned char buf[] = {0x75,0x03,0x00,0x03};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

			do{
				unsigned char buf[] = {0x76,0x07,0x00,0x03};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

#endif
		} else {
			printk("%s: CE off.\n", __func__);
#if 1
			//otm1280a_write_1(0x70, 0x00);
#if 1
			do{
				unsigned char buf[] = {0x74,0x00,0x00,0x06};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);
#endif

			do{
				unsigned char buf[] = {0x75,0x00,0x00,0x07};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

			do{
				unsigned char buf[] = {0x76,0x00,0x00,0x06};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

#endif

		}
	} else {
#if 0
		if (value) {
			printk("%s boe ce on, value = %d\n", __func__, value);
			otm1280a_write_1(0xe6, 0x01);
			otm1280a_write_1(0xe4, value);
		} else {
			printk("%s boe ce off\n", __func__);
			otm1280a_write_1(0xe6, 0x00);
			otm1280a_write_1(0xe4, 0x00);
		}
#endif
	}

	return 0;
}
#endif

typedef struct 
{
	unsigned char add;
	unsigned char data;
}para_1_data;
para_1_data yt_code[]={
	{0xFF,0x00},
	{0xBA,0x03},//0x02//4 lane
	{0xC2,0x03},//video mode
	{0xFF,0x01},
	{0x00,0x3A},
	{0x01,0x33},
	{0x02,0x53},
	{0x09,0x85},
	{0x0E,0x25},
	{0x0F,0x0A},
	{0x0B,0x97},
	{0x0C,0x97},
	{0x11,0x8A},
	{0x36,0x7B},
	{0x71,0x2C},
	{0xFF,0x05},
	
	//ltps timing
	{0x01,0x00},
	{0x02,0x8D},
	{0x03,0x8D},
	{0x04,0x8D},
	{0x05,0x30},
	{0x06,0x33},
	{0x07,0x77},
	{0x08,0x00},
	{0x09,0x00},
	{0x0A,0x00},
	{0x0B,0x80},
	{0x0C,0xC8},
	{0x0D,0x00},
	{0x0E,0x1B},
	{0x0F,0x07},
	{0x10,0x57},
	{0x11,0x00},
	{0x12,0x00},
	{0x13,0x1E},
	{0x14,0x00},
	{0x15,0x1A},
	{0x16,0x05},
	{0x17,0x00},
	{0x18,0x1E},
	{0x19,0xFF},
	{0x1A,0x00},
	{0x1B,0xFC},   
	//GRESET_inverse
	{0x1C,0x80},
	{0x1D,0x00},
	{0x1E,0x10},
	{0x1F,0x77},
	{0x20,0x00},
	
	//Gate inverse
	{0x21,0x06},	//invers display, default is 0x00
	{0x22,0x55},
	{0x23,0x0D},
	{0x31,0xA0},
	{0x32,0x00},
	{0x33,0xB8},
	{0x34,0xBB},
	{0x35,0x11},
	{0x36,0x01},
	{0x37,0x0B},
	{0x38,0x01},
	{0x39,0x0B},
	{0x44,0x08},
	{0x45,0x80},
	{0x46,0xCC},
	{0x47,0x04},
	{0x48,0x00},
	{0x49,0x00},
	{0x4A,0x01},
	{0x6C,0x03},
	{0x6D,0x03},
	{0x6E,0x2F},
	{0x43,0x00},
	{0x4B,0x23},
	{0x4C,0x01},
	{0x50,0x23},
	{0x51,0x01},
	{0x58,0x23},
	{0x59,0x01},
	{0x5D,0x23},
	{0x5E,0x01},
	{0x62,0x23},
	{0x63,0x01},
	{0x67,0x23},
	{0x68,0x01},
	{0x89,0x00},
	{0x8D,0x01},
	{0x8E,0x64},
	{0x8F,0x20},
	{0x97,0x8E},
	{0x82,0x8C},
	{0x83,0x02},
	{0xBB,0x0A},
	{0xBC,0x0A},
	{0x24,0x25},
	{0x25,0x55},
	{0x26,0x05},
	{0x27,0x23},
	{0x28,0x01},
	{0x29,0x31},
	{0x2A,0x5D},
	{0x2B,0x01},
	{0x2F,0x00},
	{0x30,0x10},
	{0xA7,0x12},
	{0x2D,0x03},
	//CMD2,Page0_Gamma2.0
	{0xFF,0x01},
	//R+
	{0x75,0x00},   
	{0x76,0x01},   
	{0x77,0x00},   
	{0x78,0x20},   
	{0x79,0x00},   
	{0x7A,0x4B},   
	{0x7B,0x00},   
	{0x7C,0x6A},   
	{0x7D,0x00},   
	{0x7E,0x82},   
	{0x7F,0x00},   
	{0x80,0x96},   
	{0x81,0x00},   
	{0x82,0xA8},   
	{0x83,0x00},   
	{0x84,0xB8},   
	{0x85,0x00},   
	{0x86,0xC7},   
	{0x87,0x00},   
	{0x88,0xF7},   
	{0x89,0x01},   
	{0x8A,0x1E},   
	{0x8B,0x01},   
	{0x8C,0x59},   
	{0x8D,0x01},   
	{0x8E,0x89},   
	{0x8F,0x01},   
	{0x90,0xD4},   
	{0x91,0x02},   
	{0x92,0x11},   
	{0x93,0x02},   
	{0x94,0x12},   
	{0x95,0x02},   
	{0x96,0x4A},   
	{0x97,0x02},   
	{0x98,0x88},   
	{0x99,0x02},   
	{0x9A,0xAF},   
	{0x9B,0x02},   
	{0x9C,0xE5},   
	{0x9D,0x03},   
	{0x9E,0x0A},   
	{0x9F,0x03},   
	{0xA0,0x3C},   
	{0xA2,0x03},   
	{0xA3,0x4D},   
	{0xA4,0x03},   
	{0xA5,0x83},   
	{0xA6,0x03},   
	{0xA7,0xAF},   
	{0xA9,0x03},   
	{0xAA,0xD1},   
	{0xAB,0x03},   
	{0xAC,0xE9},   
	{0xAD,0x03},   
	{0xAE,0xF7},   
	{0xAF,0x03},   
	{0xB0,0xFE},   
	{0xB1,0x03},   
	{0xB2,0xFF},   
	{0xB3,0x00},   
	{0xB4,0x01},   
	{0xB5,0x00},   
	{0xB6,0x20},   
	{0xB7,0x00},   
	{0xB8,0x4B},   
	{0xB9,0x00},   
	{0xBA,0x6A},   
	{0xBB,0x00},   
	{0xBC,0x82},   
	{0xBD,0x00},   
	{0xBE,0x96},   
	{0xBF,0x00},   
	{0xC0,0xA8},   
	{0xC1,0x00},   
	{0xC2,0xB8},   
	{0xC3,0x00},   
	{0xC4,0xC7},   
	{0xC5,0x00},   
	{0xC6,0xF7},   
	{0xC7,0x01},   
	{0xC8,0x1E},   
	{0xC9,0x01},   
	{0xCA,0x59},   
	{0xCB,0x01},   
	{0xCC,0x89},   
	{0xCD,0x01},   
	{0xCE,0xD4},   
	{0xCF,0x02},   
	{0xD0,0x11},   
	{0xD1,0x02},   
	{0xD2,0x12},   
	{0xD3,0x02},   
	{0xD4,0x4A},   
	{0xD5,0x02},   
	{0xD6,0x88},   
	{0xD7,0x02},   
	{0xD8,0xAF},   
	{0xD9,0x02},   
	{0xDA,0xE5},   
	{0xDB,0x03},   
	{0xDC,0x0A},   
	{0xDD,0x03},   
	{0xDE,0x3C},   
	{0xDF,0x03},   
	{0xE0,0x4D},   
	{0xE1,0x03},   
	{0xE2,0x83},   
	{0xE3,0x03},   
	{0xE4,0xAF},   
	{0xE5,0x03},   
	{0xE6,0xD1},   
	{0xE7,0x03},   
	{0xE8,0xE9},   
	{0xE9,0x03},   
	{0xEA,0xF7},   
	{0xEB,0x03},   
	{0xEC,0xFE},   
	{0xED,0x03},   
	{0xEE,0xFF},   
	{0xEF,0x00},   
	{0xF0,0xDB},   
	{0xF1,0x00},   
	{0xF2,0xE1},   
	{0xF3,0x00},   
	{0xF4,0xEE},   
	{0xF5,0x00},   
	{0xF6,0xFB},   
	{0xF7,0x01},   
	{0xF8,0x06},   
	{0xF9,0x01},   
	{0xFA,0x11},   
	{0xFF,0x02},   
	{0x00,0x01},   
	{0x01,0x1B},   
	{0x02,0x01},   
	{0x03,0x24},   
	{0x04,0x01},   
	{0x05,0x2B},   
	{0x06,0x01},   
	{0x07,0x46},   
	{0x08,0x01},   
	{0x09,0x5E},   
	{0x0A,0x01},   
	{0x0B,0x89},   
	{0x0C,0x01},   
	{0x0D,0xAD},   
	{0x0E,0x01},   
	{0x0F,0xEA},   
	{0x10,0x02},   
	{0x11,0x1E},   
	{0x12,0x02},   
	{0x13,0x1F},   
	{0x14,0x02},   
	{0x15,0x52},   
	{0x16,0x02},   
	{0x17,0x8B},   
	{0x18,0x02},   
	{0x19,0xAF},   
	{0x1A,0x02},   
	{0x1B,0xDE},   
	{0x1C,0x02},   
	{0x1D,0xFD},   
	{0x1E,0x03},   
	{0x1F,0x23},   
	{0x20,0x03},   
	{0x21,0x2E},   
	{0x22,0x03},   
	{0x23,0x3A},   
	{0x24,0x03},   
	{0x25,0x3B},   
	{0x26,0x03},   
	{0x27,0x3C},   
	{0x28,0x03},   
	{0x29,0x3D},   
	{0x2A,0x03},   
	{0x2B,0x94},   
	{0x2D,0x03},   
	{0x2F,0x97},   
	{0x30,0x03},   
	{0x31,0xFF},   
	{0x32,0x00},   
	{0x33,0xDB},   
	{0x34,0x00},   
	{0x35,0xE1},   
	{0x36,0x00},   
	{0x37,0xEE},   
	{0x38,0x00},   
	{0x39,0xFB},   
	{0x3A,0x01},   
	{0x3B,0x06},   
	{0x3D,0x01},   
	{0x3F,0x11},   
	{0x40,0x01},   
	{0x41,0x1B},   
	{0x42,0x01},   
	{0x43,0x24},   
	{0x44,0x01},   
	{0x45,0x2B},   
	{0x46,0x01},   
	{0x47,0x46},   
	{0x48,0x01},   
	{0x49,0x5E},   
	{0x4A,0x01},   
	{0x4B,0x89},   
	{0x4C,0x01},   
	{0x4D,0xAD},   
	{0x4E,0x01},   
	{0x4F,0xEA},   
	{0x50,0x02},   
	{0x51,0x1E},   
	{0x52,0x02},   
	{0x53,0x1F},   
	{0x54,0x02},   
	{0x55,0x52},   
	{0x56,0x02},   
	{0x58,0x8B},   
	{0x59,0x02},   
	{0x5A,0xAF},   
	{0x5B,0x02},   
	{0x5C,0xDE},   
	{0x5D,0x02},   
	{0x5E,0xFD},   
	{0x5F,0x03},   
	{0x60,0x23},   
	{0x61,0x03},   
	{0x62,0x2E},   
	{0x63,0x03},   
	{0x64,0x3A},   
	{0x65,0x03},   
	{0x66,0x3B},   
	{0x67,0x03},   
	{0x68,0x3C},   
	{0x69,0x03},   
	{0x6A,0x3D},   
	{0x6B,0x03},   
	{0x6C,0x94},   
	{0x6D,0x03},   
	{0x6E,0x97},   
	{0x6F,0x03},   
	{0x70,0xFF},   
	{0x71,0x01},   
	{0x72,0x11},   
	{0x73,0x01},   
	{0x74,0x14},   
	{0x75,0x01},   
	{0x76,0x1B},   
	{0x77,0x01},   
	{0x78,0x23},   
	{0x79,0x01},   
	{0x7A,0x29},   
	{0x7B,0x01},   
	{0x7C,0x30},   
	{0x7D,0x01},   
	{0x7E,0x37},   
	{0x7F,0x01},   
	{0x80,0x3D},   
	{0x81,0x01},   
	{0x82,0x43},   
	{0x83,0x01},   
	{0x84,0x5A},   
	{0x85,0x01},   
	{0x86,0x6F},   
	{0x87,0x01},   
	{0x88,0x94},   
	{0x89,0x01},   
	{0x8A,0xB5},   
	{0x8B,0x01},   
	{0x8C,0xEE},   
	{0x8D,0x02},   
	{0x8E,0x20},   
	{0x8F,0x02},   
	{0x90,0x21},   
	{0x91,0x02},   
	{0x92,0x53},   
	{0x93,0x02},   
	{0x94,0x8D},   
	{0x95,0x02},   
	{0x96,0xB1},   
	{0x97,0x02},   
	{0x98,0xE1},   
	{0x99,0x03},   
	{0x9A,0x01},   
	{0x9B,0x03},   
	{0x9C,0x2A},   
	{0x9D,0x03},   
	{0x9E,0x36},   
	{0x9F,0x03},   
	{0xA0,0x42},   
	{0xA2,0x03},   
	{0xA3,0x54},   
	{0xA4,0x03},   
	{0xA5,0x62},   
	{0xA6,0x03},   
	{0xA7,0x76},   
	{0xA9,0x03},   
	{0xAA,0x94},   
	{0xAB,0x03},   
	{0xAC,0x97},   
	{0xAD,0x03},   
	{0xAE,0xFF},   
	{0xAF,0x01},   
	{0xB0,0x11},   
	{0xB1,0x01},   
	{0xB2,0x14},   
	{0xB3,0x01},   
	{0xB4,0x1B},   
	{0xB5,0x01},   
	{0xB6,0x23},   
	{0xB7,0x01},   
	{0xB8,0x29},   
	{0xB9,0x01},   
	{0xBA,0x30},   
	{0xBB,0x01},   
	{0xBC,0x37},   
	{0xBD,0x01},   
	{0xBE,0x3D},   
	{0xBF,0x01},   
	{0xC0,0x43},   
	{0xC1,0x01},   
	{0xC2,0x5A},   
	{0xC3,0x01},   
	{0xC4,0x6F},   
	{0xC5,0x01},   
	{0xC6,0x94},   
	{0xC7,0x01},   
	{0xC8,0xB5},   
	{0xC9,0x01},   
	{0xCA,0xEE},   
	{0xCB,0x02},   
	{0xCC,0x20},   
	{0xCD,0x02},   
	{0xCE,0x21},   
	{0xCF,0x02},   
	{0xD0,0x53},   
	{0xD1,0x02},   
	{0xD2,0x8D},   
	{0xD3,0x02},   
	{0xD4,0xB1},   
	{0xD5,0x02},   
	{0xD6,0xE1},   
	{0xD7,0x03},   
	{0xD8,0x01},   
	{0xD9,0x03},   
	{0xDA,0x2A},   
	{0xDB,0x03},   
	{0xDC,0x36},   
	{0xDD,0x03},   
	{0xDE,0x42},   
	{0xDF,0x03},   
	{0xE0,0x54},   
	{0xE1,0x03},   
	{0xE2,0x62},   
	{0xE3,0x03},   
	{0xE4,0x76},   
	{0xE5,0x03},   
	{0xE6,0x94},   
	{0xE7,0x03},   
	{0xE8,0x97},   
	{0xE9,0x03},   
	{0xEA,0xFF},   

	//color enhence
	{0xFF,0x03}, 
	{0xFE,0x08}, 
	{0x18,0x00}, 
	{0x19,0x00}, 
	{0x1A,0x00}, 
	{0x25,0x26}, 
	{0x00,0x00}, 
	{0x01,0x03}, 
	{0x02,0x07}, 
	{0x03,0x0D}, 
	{0x04,0x0F}, 
	{0x05,0x13}, 
	{0x06,0x17}, 
	{0x07,0x1B}, 
	{0x08,0x1F}, 
	{0x09,0x23}, 
	{0x0A,0x27}, 
	{0x0B,0x2B}, 
	{0x0C,0x2F}, 
	{0x0D,0x33}, 
	{0x0E,0x37}, 
	{0x0F,0x3D}, 

	//CMD 1
	{0xFF,0x00},
	{0xFB,0x01},
	//CMD2,PAGE0
	{0xFF,0x01},
	{0xFB,0x01},
	//CMD2,PAGE1
	{0xFF,0x02},
	{0xFB,0x01},
	//CMD2,PAGE2
	{0xFF,0x03},
	{0xFB,0x01},
	//CMD2,PAGE3
	{0xFF,0x04},
	{0xFB,0x01},
	//CMD2,PAGE4
	{0xFF,0x05},
	{0xFB,0x01},
	//CMD1
	{0xFF,0x00},
	{0xFF,0xff},	//end
};
para_1_data cmi_code[]={
	//CMD1
	{0xFF,0x00},
	{0xBA,0x03},//MIPI 4 lanes
	{0xC2,0x03},//MIPI Video mode
	//CMD2,Page0
	{0xFF,0x01},
	{0x00,0x3A},//Set VGSW/NB/720x480
	{0x01,0x33},//Charge Pump clockÔO¶¨
	{0x02,0x53},
	{0x09,0x85},//VGL=-6V
	{0x0E,0x25},//VGH=+8.6V
	{0x0F,0x0A},//turn off VGLO regulator
	{0x0B,0x97},//GVDDP=4V
	{0x0C,0x97},//GVDDN=-4V
	{0x11,0x8A},//VCOMDC3=-0.24V_2012/07/06
	{0x36,0x7B},//Open Gate_EQ_Cut2_2012/04/13_Duncan
	{0x71,0x2C},//ÔO¶¨MIPI TA_GO_2011/11/29_Duncan
	//CMD2,Page4
	{0xFF,0x05},
	//LTPS timing
	{0x01,0x00},
	{0x02,0x8D},
	{0x03,0x8D},
	{0x04,0x8D},
	{0x05,0x30},
	{0x06,0x33},
	{0x07,0x77},
	{0x08,0x00},
	{0x09,0x00},
	{0x0A,0x00},
	{0x0B,0x80},
	{0x0C,0xC8},
	{0x0D,0x00},
	{0x0E,0x1B},
	{0x0F,0x07},
	{0x10,0x57},
	{0x11,0x00},
	{0x12,0x00},
	{0x13,0x1E},
	{0x14,0x00},
	{0x15,0x1A},
	{0x16,0x05},
	{0x17,0x00},
	{0x18,0x1E},
	{0x19,0xFF},
	{0x1A,0x00},
	{0x1B,0xFC},
	//2012/07,/02 GRESET_inverse_Henry
	{0x1C,0x80},
	{0x1D,0x10},
	{0x1E,0x01},
	//2012/07,/02 GRESET_inverse_Henry
	{0x1F,0x77},
	{0x20,0x00},
	//2012/07,/02 Gate inverse
	{0x21,0x00},
	{0x22,0x55},
	{0x23,0x0D},
	{0x31,0xA0},
	{0x32,0x00},
	{0x33,0xB8},
	{0x34,0xBB},
	{0x35,0x11},
	{0x36,0x01},
	{0x37,0x0B},
	{0x38,0x01},
	{0x39,0x0B},
	{0x44,0x08},
	{0x45,0x80},
	{0x46,0xCC}, 
	{0x47,0x04},
	{0x48,0x00},
	{0x49,0x00},
	{0x4A,0x01},
	{0x6C,0x03},
	{0x6D,0x03},
	{0x6E,0x2F},
	{0x43,0x00},
	{0x4B,0x23},
	{0x4C,0x01},
	{0x50,0x23},
	{0x51,0x01},
	{0x58,0x23},
	{0x59,0x01},
	{0x5D,0x23},
	{0x5E,0x01},
	{0x62,0x23},
	{0x63,0x01},
	{0x67,0x23},
	{0x68,0x01},
	{0x89,0x00},
	{0x8D,0x01},
	{0x8E,0x64},
	{0x8F,0x20},
	{0x97,0x8E},
	{0x82,0x8C},
	{0x83,0x02},
	{0xBB,0x0A},
	{0xBC,0x0A},
	{0x24,0x25},
	{0x25,0x55},
	{0x26,0x05},
	{0x27,0x23},
	{0x28,0x01},
	{0x29,0x31},
	{0x2A,0x5D},
	{0x2B,0x01},
	{0x2F,0x00},
	{0x30,0x10},
	{0xA7,0x12},
	{0x2D,0x03},
	//CMD2,Pa,ge0_Gamma2.2_2012/07/06
	{0xFF,0x01},
	//R+
	{0x75,0x00},
	{0x76,0x42},
	{0x77,0x00},
	{0x78,0x51},
	{0x79,0x00},
	{0x7A,0x6B},
	{0x7B,0x00},
	{0x7C,0x81},
	{0x7D,0x00},
	{0x7E,0x94},
	{0x7F,0x00},
	{0x80,0xA5},
	{0x81,0x00},
	{0x82,0xB3},
	{0x83,0x00},
	{0x84,0xC1},
	{0x85,0x00},
	{0x86,0xCD},
	{0x87,0x00},
	{0x88,0xF9},
	{0x89,0x01},
	{0x8A,0x1F},
	{0x8B,0x01},
	{0x8C,0x59},
	{0x8D,0x01},
	{0x8E,0x85},
	{0x8F,0x01},
	{0x90,0xD1},
	{0x91,0x02},
	{0x92,0x0C},
	{0x93,0x02},
	{0x94,0x0E},
	{0x95,0x02},
	{0x96,0x44},
	{0x97,0x02},
	{0x98,0x80},
	{0x99,0x02},
	{0x9A,0xA6},
	{0x9B,0x02},
	{0x9C,0xD3},
	{0x9D,0x02},
	{0x9E,0xF4},
	{0x9F,0x03},
	{0xA0,0x1E},
	{0xA2,0x03},
	{0xA3,0x29},
	{0xA4,0x03},
	{0xA5,0x36},
	{0xA6,0x03},
	{0xA7,0x44},
	{0xA9,0x03},
	{0xAA,0x57},
	{0xAB,0x03},
	{0xAC,0x68},
	{0xAD,0x03},
	{0xAE,0x7A},
	{0xAF,0x03},
	{0xB0,0x89},
	{0xB1,0x03},
	{0xB2,0x95},
	//R- 
	{0xB3,0x00},
	{0xB4,0x42},
	{0xB5,0x00},
	{0xB6,0x51},
	{0xB7,0x00},
	{0xB8,0x6B},
	{0xB9,0x00},
	{0xBA,0x81},
	{0xBB,0x00},
	{0xBC,0x94},
	{0xBD,0x00},
	{0xBE,0xA5},
	{0xBF,0x00},
	{0xC0,0xB3},
	{0xC1,0x00},
	{0xC2,0xC1},
	{0xC3,0x00},
	{0xC4,0xCD},
	{0xC5,0x00},
	{0xC6,0xF9},
	{0xC7,0x01},
	{0xC8,0x1F},
	{0xC9,0x01},
	{0xCA,0x59},
	{0xCB,0x01},
	{0xCC,0x85},
	{0xCD,0x01},
	{0xCE,0xD1},
	{0xCF,0x02},
	{0xD0,0x0C},
	{0xD1,0x02},
	{0xD2,0x0E},
	{0xD3,0x02},
	{0xD4,0x44},
	{0xD5,0x02},
	{0xD6,0x80},
	{0xD7,0x02},
	{0xD8,0xA6},
	{0xD9,0x02},
	{0xDA,0xD3},
	{0xDB,0x02},
	{0xDC,0xF4},
	{0xDD,0x03},
	{0xDE,0x1E},
	{0xDF,0x03},
	{0xE0,0x29},
	{0xE1,0x03},
	{0xE2,0x36},
	{0xE3,0x03},
	{0xE4,0x44},
	{0xE5,0x03},
	{0xE6,0x57},
	{0xE7,0x03},
	{0xE8,0x68},
	{0xE9,0x03},
	{0xEA,0x7A},
	{0xEB,0x03},
	{0xEC,0x89},
	{0xED,0x03},
	{0xEE,0x95},
	//G+
	{0xEF,0x00},
	{0xF0,0x42},
	{0xF1,0x00},
	{0xF2,0x51},
	{0xF3,0x00},
	{0xF4,0x6B},
	{0xF5,0x00},
	{0xF6,0x81},
	{0xF7,0x00},
	{0xF8,0x94},
	{0xF9,0x00},
	{0xFA,0xA5},
	//CMD2,Pa,ge1
	{0xFF,0x02}, 
	//CMD2,Pa,ge1
	{0x00,0x00},
	{0x01,0xB3},
	{0x02,0x00},
	{0x03,0xC1},
	{0x04,0x00},
	{0x05,0xCD},
	{0x06,0x00},
	{0x07,0xF9},
	{0x08,0x01},
	{0x09,0x1F},
	{0x0A,0x01},
	{0x0B,0x59},
	{0x0C,0x01},
	{0x0D,0x85},
	{0x0E,0x01},
	{0x0F,0xD1},
	{0x10,0x02},
	{0x11,0x0C},
	{0x12,0x02},
	{0x13,0x0E},
	{0x14,0x02},
	{0x15,0x44},
	{0x16,0x02},
	{0x17,0x80},
	{0x18,0x02},
	{0x19,0xA6},
	{0x1A,0x02},
	{0x1B,0xD3},
	{0x1C,0x02},
	{0x1D,0xF4},
	{0x1E,0x03},
	{0x1F,0x1E},
	{0x20,0x03},
	{0x21,0x29},
	{0x22,0x03},
	{0x23,0x36},
	{0x24,0x03},
	{0x25,0x44},
	{0x26,0x03},
	{0x27,0x57},
	{0x28,0x03},
	{0x29,0x68},
	{0x2A,0x03},
	{0x2B,0x7A},
	{0x2D,0x03},
	{0x2F,0x89},
	{0x30,0x03},
	{0x31,0x95},
	//G-   
	{0x32,0x00},
	{0x33,0x42},
	{0x34,0x00},
	{0x35,0x51},
	{0x36,0x00},
	{0x37,0x6B},
	{0x38,0x00},
	{0x39,0x81},
	{0x3A,0x00},
	{0x3B,0x94},
	{0x3D,0x00},
	{0x3F,0xA5},
	{0x40,0x00},
	{0x41,0xB3},
	{0x42,0x00},
	{0x43,0xC1},
	{0x44,0x00},
	{0x45,0xCD},
	{0x46,0x00},
	{0x47,0xF9},
	{0x48,0x01},
	{0x49,0x1F},
	{0x4A,0x01},
	{0x4B,0x59},
	{0x4C,0x01},
	{0x4D,0x85},
	{0x4E,0x01},
	{0x4F,0xD1},
	{0x50,0x02},
	{0x51,0x0C},
	{0x52,0x02},
	{0x53,0x0E},
	{0x54,0x02},
	{0x55,0x44},
	{0x56,0x02},
	{0x58,0x80},
	{0x59,0x02},
	{0x5A,0xA6},
	{0x5B,0x02},
	{0x5C,0xD3},
	{0x5D,0x02},
	{0x5E,0xF4},
	{0x5F,0x03},
	{0x60,0x1E},
	{0x61,0x03},
	{0x62,0x29},
	{0x63,0x03},
	{0x64,0x36},
	{0x65,0x03},
	{0x66,0x44},
	{0x67,0x03},
	{0x68,0x57},
	{0x69,0x03},
	{0x6A,0x68},
	{0x6B,0x03},
	{0x6C,0x7A},
	{0x6D,0x03},
	{0x6E,0x89},
	{0x6F,0x03},
	{0x70,0x95},
	//B+
	{0x71,0x00},
	{0x72,0x42},
	{0x73,0x00},
	{0x74,0x51},
	{0x75,0x00},
	{0x76,0x6B},
	{0x77,0x00},
	{0x78,0x81},
	{0x79,0x00},
	{0x7A,0x94},
	{0x7B,0x00},
	{0x7C,0xA5},
	{0x7D,0x00},
	{0x7E,0xB3},
	{0x7F,0x00},
	{0x80,0xC1},
	{0x81,0x00},
	{0x82,0xCD},
	{0x83,0x00},
	{0x84,0xF9},
	{0x85,0x01},
	{0x86,0x1F},
	{0x87,0x01},
	{0x88,0x59},
	{0x89,0x01},
	{0x8A,0x85},
	{0x8B,0x01},
	{0x8C,0xD1},
	{0x8D,0x02},
	{0x8E,0x0C},
	{0x8F,0x02},
	{0x90,0x0E},
	{0x91,0x02},
	{0x92,0x44},
	{0x93,0x02},
	{0x94,0x80},
	{0x95,0x02},
	{0x96,0xA6},
	{0x97,0x02},
	{0x98,0xD3},
	{0x99,0x02},
	{0x9A,0xF4},
	{0x9B,0x03},
	{0x9C,0x1E},
	{0x9D,0x03},
	{0x9E,0x29},
	{0x9F,0x03},
	{0xA0,0x36},
	{0xA2,0x03},
	{0xA3,0x44},
	{0xA4,0x03},
	{0xA5,0x57},
	{0xA6,0x03},
	{0xA7,0x68},
	{0xA9,0x03},
	{0xAA,0x7A},
	{0xAB,0x03},
	{0xAC,0x89},
	{0xAD,0x03},
	{0xAE,0x95},
	//B-
	{0xAF,0x00},
	{0xB0,0x42},
	{0xB1,0x00},
	{0xB2,0x51},
	{0xB3,0x00},
	{0xB4,0x6B},
	{0xB5,0x00},
	{0xB6,0x81},
	{0xB7,0x00},
	{0xB8,0x94},
	{0xB9,0x00},
	{0xBA,0xA5},
	{0xBB,0x00},
	{0xBC,0xB3},
	{0xBD,0x00},
	{0xBE,0xC1},
	{0xBF,0x00},
	{0xC0,0xCD},
	{0xC1,0x00},
	{0xC2,0xF9},
	{0xC3,0x01},
	{0xC4,0x1F},
	{0xC5,0x01},
	{0xC6,0x59},
	{0xC7,0x01},
	{0xC8,0x85},
	{0xC9,0x01},
	{0xCA,0xD1},
	{0xCB,0x02},
	{0xCC,0x0C},
	{0xCD,0x02},
	{0xCE,0x0E},
	{0xCF,0x02},
	{0xD0,0x44},
	{0xD1,0x02},
	{0xD2,0x80},
	{0xD3,0x02},
	{0xD4,0xA6},
	{0xD5,0x02},
	{0xD6,0xD3},
	{0xD7,0x02},
	{0xD8,0xF4},
	{0xD9,0x03},
	{0xDA,0x1E},
	{0xDB,0x03},
	{0xDC,0x29},
	{0xDD,0x03},
	{0xDE,0x36},
	{0xDF,0x03},
	{0xE0,0x44},
	{0xE1,0x03},
	{0xE2,0x57},
	{0xE3,0x03},
	{0xE4,0x68},
	{0xE5,0x03},
	{0xE6,0x7A},
	{0xE7,0x03},
	{0xE8,0x89},
	{0xE9,0x03},
	{0xEA,0x95},
	//CMD1
	{0xFF,0x00},
	{0xFB,0x01},
	//CMD2,Page0
	{0xFF,0x01},
	{0xFB,0x01},
	//CMD2,Page1
	{0xFF,0x02},
	{0xFB,0x01},
	//CMD2,Page2
	{0xFF,0x03},
	{0xFB,0x01},
	//CMD2,Page3
	{0xFF,0x04},
	{0xFB,0x01},
	//CMD2,Page4
	{0xFF,0x05},
	{0xFB,0x01},
	//CMD1
	{0xFF,0x00},
	{0xFF,0xff},	//end
};

int g_lcd_nova = 0;
static int k3_get_panel_id(void)
{
	unsigned int read_buf[100];
	char run_cmd[100];
	memset(read_buf, 0, sizeof(read_buf));
	unsigned char buf[] = {0xf4};
	int i = 0;
	int novaID = 0, LGID = 0, BOEID = 0;

	lcd_reset();
#if 1		
        ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  (unsigned int )buf, sizeof buf);
        int read_size = -1;
        ddi_pd->cmd_write(ddi_pd->dsim_base, SET_MAX_RTN_PKT_SIZE, 100, 0);
        s5p_dsim_clr_state(ddi_pd->dsim_base,RxDatDone);
        ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_RD_NO_PARA, (u8)buf[0], 0);
        s5p_dsim_wait_state(ddi_pd->dsim_base, RxDatDone);
        s5p_dsim_read_rx_fifo(ddi_pd->dsim_base, read_buf, &read_size);
#endif
        u8 *p = (u8*)read_buf;
        for (i = 0; i < 1; i++)
                printf("novaid = %#x \n", p[i]);
	novaID = p[0];

	if(read_size != -1)
	{
#if 1	
		buf[0] = 0xa1;	//for LG driver IC
	        ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  (unsigned int )buf, sizeof buf);
	        ddi_pd->cmd_write(ddi_pd->dsim_base, SET_MAX_RTN_PKT_SIZE, 100, 0);
	        s5p_dsim_clr_state(ddi_pd->dsim_base,RxDatDone);
	        ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_RD_NO_PARA, (u8)buf[0], 0);
	        s5p_dsim_wait_state(ddi_pd->dsim_base, RxDatDone);
	        s5p_dsim_read_rx_fifo(ddi_pd->dsim_base, read_buf, &read_size);
#endif
	        for (i = 0; i < 10; i++)
	                printf("lgid = %#x \n", p[i]);
		LGID = (p[6]<<8)|p[7];
	}
                
#if 0	
	if(read_size != -1)
	{
		buf[0] = 0xf4;	//for BOE driver IC
	        ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  (unsigned int )buf, sizeof buf);
	        ddi_pd->cmd_write(ddi_pd->dsim_base, SET_MAX_RTN_PKT_SIZE, 100, 0);
	        s5p_dsim_clr_state(ddi_pd->dsim_base,RxDatDone);
	        ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_RD_NO_PARA, (u8)buf[0], 0);
	        s5p_dsim_wait_state(ddi_pd->dsim_base, RxDatDone);
	        s5p_dsim_read_rx_fifo(ddi_pd->dsim_base, read_buf, &read_size);
	        for (i = 0; i < 1; i++)
	                printf("boeid = %#x \n", p[i]);
		BOEID = p[0];
	}
#endif
                
	if(novaID == 0x90 && LGID !=0x4591)// && BOEID !=0x83)
	{
		g_lcd_nova = 1;
		if(gpio_lcd)
			lcd_id = LCD_NOVA_YASSY;
		else
			lcd_id = LCD_NOVA_CMI;
	}else
	{
		g_lcd_nova = 0;
		if(gpio_lcd)
			lcd_id = LCD_LG;		//id is 
		else
			lcd_id = LCD_BOE;	//id is 0
	}
	
	if (read_size == -1){
		g_no_lcd_connected = 1;
	}
	
	printf("k3_get_panel_id = %#d , g_no_lcd_connected=%d  novaID=%x  LGID=%x BOEID=%x\n", lcd_id, g_no_lcd_connected, novaID, LGID, BOEID);
	/* save it to cmdline for lcd check */
	sprintf(run_cmd, "setenv bootargs ${bootargs} lcd_nova=%d", g_lcd_nova);
	run_command(run_cmd, 0);
	return lcd_id;
}

int lcd_pannel_on(void)
{
	int ret = DSIM_TRUE;
	int i = 0;

	if(g_no_lcd_connected)
		return;
	if (lcd_id == LCD_BOE) {
		//##########################################
		printf("##start cmmd_write sequence for LCD_BOE##\n");
		otm1280a_write_0(0x11);
		mdelay(200);

		do{
			unsigned char buf[] = {0xB9,0xFF,0x83,0x94};
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
		}while(0);

		do{
			unsigned char buf[] = {0xBA,0x13};
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
		}while(0);
		//be sure 0xcc is wrote correctly
		otm1280a_write_1(0xcc, 0x05);
		do{
			unsigned char buf[] = {0xB1,0x7C,0x00,0x24,0x09,0x01,0x11,0x11,0x36,0x3e,0x26,0x26,0x57,0x0a,0x01,0xe6};
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
		}while(0);
		do{
			unsigned char buf[] = {0xB2,0x0f,0xc8,0x04,0x04,0x00,0x81};
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
		}while(0);
		do{
			unsigned char buf[] = {0xBf,0x06,0x10};
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
		}while(0);
		do{
			unsigned char buf[] = {0xB4,0x00,0x00,0x00,0x05,0x06,0x41,0x42,0x02,0x41,0x42,0x43,0x47,0x19,0x58,0x60,0x08,0x85,0x10};
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
		}while(0);
		do{
			unsigned char buf[] = {0xD5,0x4C,0x01,0x07,0x01,0xCD,0x23,0xEF,0x45,0x67,0x89,0xAB,0x11,0x00,0xDC,0x10,0xFE,0x32,0xBA,0x98,0x76,0x54,0x00,0x11,0x40};
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
		}while(0);
		do{
			unsigned char buf[] = {0xE0,0x24,0x33,0x36,
								0x3F,0x3f,0x3f,0x3c,
								0x56,0x05,0x0c,0x0e,
								0x11,0x13,0x12,0x14,
								0x12,0x1e,0x24,0x33,
								0x36,0x3f,0x3f,0x3f,
								0x3c,0x56,0x05,0x0c,
								0x0e,0x11,0x13,0x12,
								0x14,0x12,0x1e};
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
		}while(0);
#if 1
		do{
			unsigned char buf[] = {
0xC1,
0x01,
0x00,
0x07,
0x10,
0x16,
0x1B,
0x25,
0x2C,
0x34,
0x38,
0x44,
0x4B,
0x52,
0x5B,
0x61,
0x6A,
0x71,
0x79,
0x82,
0x89,
0x91,
0x9B,
0xA4,
0xAC,
0xB5,
0xBD,
0xC6,
0xCD,
0xD6,
0xDD,
0xE4,
0xEC,
0xF4,
0xFB,
0x05,
0xEA,
0xC9,
0xB0,
0x02,
0x5F,
0xFD,
0x73,
0xC0,
0x00,
0x03,
0x0E,
0x14,
0x19,
0x20,
0x28,
0x2F,
0x33,
0x3D,
0x43,
0x4A,
0x52,
0x57,
0x60,
0x66,
0x6E,
0x75,
0x7C,
0x83,
0x8B,
0x93,
0x9B,
0xA3,
0xAA,
0xB3,
0xBA,
0xC2,
0xC9,
0xCF,
0xD7,
0xDE,
0xE5,
0x05,
0xEA,
0xC9,
0xB1,
0x02,
0x5F,
0xFD,
0x73,
0xC0,
0x00,
0x01,
0x0F,
0x16,
0x1C,
0x26,
0x2E,
0x36,
0x3B,
0x47,
0x4E,
0x56,
0x5F,
0x65,
0x6F,
0x76,
0x7F,
0x88,
0x90,
0x99,
0xA2,
0xAC,
0xB4,
0xBD,
0xC5,
0xCD,
0xD5,
0xDE,
0xE5,
0xEB,
0xF4,
0xFA,
0xFF,
0x05,
0xEA,
0xC9,
0xB1,
0x02,
0x5F,
0xFD,
0x73,
0xC0
};
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
		}while(0);
#endif
		otm1280a_write_1(0xe3, 0x01);
		do{
			unsigned char buf[] = {0xE5,0x00,0x00,0x04,
								0x04,0x02,0x00,0x80,
								0x20,0x00,0x20,0x00,
								0x00,0x08,0x06,0x04,
								0x00,0x80,0x0E};
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
		}while(0);

		do{
			unsigned char buf[] = {0xC7,0x00,0x20};
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
		}while(0);

		//do{
		//	unsigned char buf[] = {0xcc,0x01};
		//	ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
		//	if (ret == 0){
		//		printk("cmmd_write error\n");
		//		return ret;
		//	}
		//}while(0);

		do{
			unsigned char buf[] = {0xb6,0x2a};
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
		}while(0);
#ifdef LCD_CE_INTERFACE
		ce_on_off(ce_mode);
#endif
		//otm1280a_write_1(0x36, 0x01);	//only for command mode
		//otm1280a_write_1(0xcc, 0x01);

		/* Set Display ON */
		otm1280a_write_0(0x29);
		mdelay(20);
		
	} else if (lcd_id == LCD_LG){
	
		//##########################################
		printf("##start cmmd_write sequence for LCD_LG##\n");
#if 1
		do{
			unsigned char buf[] = {0xE0,0x43,0x00,0x80,0x00,0x00};
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
		}while(0);	
		//		mdelay(1);
		//Display mode
		do{
			//unsigned char buf[] = {0xB5,0x2A,0x20,0x40,0x00,0x20};
			unsigned char buf[] = {0xB5,0x34,0x20,0x40,0x00,0x20};
#if 0
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
		//		mdelay(1);
		//GIP SDAC
		do{
			//unsigned char buf[] = {0xB1,0x7C,0x00,0x34,0x09,0x01,0x11,0x11,0x36,0x3E,0x26,0x26,0x57,0x12,0x01,0xE6};
			//unsigned char buf[] = {0xB6,0x04,0x34,0x0F,0x16,0x13};
			unsigned char buf[] = {0xB6,0x04,0x74,0x0F,0x16,0x13};
#if 0
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
		//		mdelay(1);
		//internal ocsillator setting
		do{
			unsigned char buf[] = {0xc0,0x01,0x08};
#if 1
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
		do{
			unsigned char buf[] = {0xc1,0x00};
#if 1
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
		//		mdelay(1);

		//Power setting 
		do{
			//unsigned char buf[] = {0xC3,0x01,0x09,0x10,0x02,0x00,0x66,0x20,0x03,0x02};
			unsigned char buf[] = {0xC3,0x00,0x09,0x10,0x02,0x00,0x66,0x20,0x13,0x00};
#if 0
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
		//		mdelay(1);

		do{
			//unsigned char buf[] = {0xC4,0x22,0x24,0x12,0x18,0x59};
			unsigned char buf[] = {0xC4,0x23,0x24,0x17,0x17,0x59};
#if 0
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);

		//Gamma setting
		do{
			//		unsigned char buf[] = {0xD0,0x10,0x60,0x67,0x35,0x00,0x06,0x60,0x21,0x02};
			unsigned char buf[] = {0xD0,0x21,0x13,0x67,0x37,0x0c,0x06,0x62,0x23,0x03};
#if 0
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif

		}while(0);
		//		mdelay(1);
		do{
			//unsigned char buf[] = {0xD1,0x21,0x61,0x66,0x35,0x00,0x05,0x60,0x13,0x01};
			unsigned char buf[] = {0xD1,0x32,0x13,0x66,0x37,0x02,0x06,0x62,0x23,0x03};
#if 0
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
		//		mdelay(1);

		do{
			//unsigned char buf[] = {0xD2,0x10,0x60,0x67,0x40,0x1F,0x06,0x60,0x21,0x02};
			unsigned char buf[] = {0xD2,0x41,0x14,0x56,0x37,0x0c,0x06,0x62,0x23,0x03};
#if 0
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
		//		mdelay(1);
		do{
			//	unsigned char buf[] = {0xD3,0x21,0x61,0x66,0x40,0x1F,0x05,0x60,0x13,0x01};
			unsigned char buf[] = {0xD3,0x52,0x14,0x55,0x37,0x02,0x06,0x62,0x23,0x03};
#if 0
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
		//		mdelay(1);
		do{
			//	unsigned char buf[] = {0xD4,0x10,0x60,0x67,0x35,0x00,0x06,0x60,0x21,0x02};
			unsigned char buf[] = {0xD4,0x41,0x14,0x56,0x37,0x0c,0x06,0x62,0x23,0x03};
#if 0
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
		//		mdelay(1);
		do{
			//unsigned char buf[] = {0xD5,0x21,0x61,0x66,0x35,0x00,0x05,0x60,0x13,0x01};
			unsigned char buf[] = {0xD5,0x52,0x14,0x55,0x37,0x02,0x06,0x62,0x23,0x03};
#if 0
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
		//Gamma setting end
		//		mdelay(1);
		do{
			unsigned char buf[] = {0x36,0x0B };
#if 1
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
		//		mdelay(1);
		//		otm1280a_write_0(0x11);
		//		mdelay(5);
		do{
			//unsigned char buf[] = {0xF9,0x80,0x00};
			unsigned char buf[] = {0xF9,0x00};
#if 1
			ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
			if (ret == 0){
				printk("cmmd_write error\n");
				return ret;
			}
#else
			ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
			if (ret == DSIM_FALSE){
				printk("cmd_write error\n");
				return ret;
			}
#endif
		}while(0);
#endif

#ifdef LCD_CE_INTERFACE
			otm1280a_write_1(0x70, 0x00);

			do{
				unsigned char buf[] = {0x71,0x00,0x00, 0x01, 0x01};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

			do{
				unsigned char buf[] = {0x72,0x01,0x0e};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

			do{
				unsigned char buf[] = {0x73,0x34,0x52, 0x00};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);
#if 0
			do{
				unsigned char buf[] = {0x74,0x05,0x00, 0x06};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

			do{
				unsigned char buf[] = {0x75,0x03,0x00,0x07};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

			do{
				unsigned char buf[] = {0x76,0x07, 0x00 ,0x06};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);
#endif

			do{
				unsigned char buf[] = {0x77,0x3f,0x3f, 0x3f, 0x3f, 0x3f, 0x3f, 0x3f, 0x3f};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

			do{
				unsigned char buf[] = {0x78,0x40,0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

			do{
				unsigned char buf[] = {0x79,0x40,0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

			do{
				unsigned char buf[] = {0x7A,0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

			do{
				unsigned char buf[] = {0x7B,0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);

			do{
				unsigned char buf[] = {0x7C,0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
#if 0
				ret = ddi_pd->cmd_write(ddi_pd->dsim_base, DCS_LONG_WR, (unsigned int) buf, sizeof(buf));
				if (ret == 0){
					printk("cmmd_write error\n");
					return ret;
				}
#else
				ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
				if (ret == DSIM_FALSE){
					printk("cmd_write error\n");
					return ret;
				}
#endif
			}while(0);
			ce_on_off(ce_mode);
#endif
	}else if (lcd_id == LCD_NOVA_CMI) 
	{
		//###############################################
		printf("##start cmmd_write sequence for LCD_NOVA_CMI##\n");
		while(1)
		{
			if(yt_code[i].add == 0xff &&  yt_code[i].data == 0xff )
				break;
			otm1280a_write_1(yt_code[i].add, yt_code[i].data);
			udelay(100);
			//printf("write %x  %x\n", yt_code[i].add, yt_code[i].data);
			i++;
		}
		printf("cmmd_write 0x11\n");
		otm1280a_write_0(0x11);
		mdelay(120);
		otm1280a_write_1(0x51, 0xff);
		mdelay(4);
		otm1280a_write_1(0x53, 0x24);
		mdelay(4);
		otm1280a_write_1(0x55, 0x80);
		mdelay(4);
		printf("cmmd_write 0x29\n");
		otm1280a_write_0(0x29);
		mdelay(4);
		otm1280a_write_1(0xFF, 0x00);
		mdelay(4);
		otm1280a_write_1(0x35, 0x00);
		mdelay(4);
	}else  if (lcd_id == LCD_NOVA_YASSY) 
	{
		//###############################################
		printf("##start cmmd_write sequence for LCD_NOVA_YASSY##\n");
		while(1)
		{
			if(yt_code[i].add == 0xff &&  yt_code[i].data == 0xff)
				break;
			otm1280a_write_1(yt_code[i].add, yt_code[i].data);
			udelay(100);
			//printf("write %x  %x\n", yt_code[i].add, yt_code[i].data);
			i++;
		}
		printf("cmmd_write 0x11\n");
		otm1280a_write_0(0x11);
		mdelay(120);
		otm1280a_write_1(0x51, 0xff);
		mdelay(4);
		otm1280a_write_1(0x53, 0x24);
		mdelay(4);
		otm1280a_write_1(0x55, 0x80);
		mdelay(4);
#if 0
		otm1280a_write_1(0x3A, 0x77);
		mdelay(50);
		unsigned char buf[] = {0x2A,0x00,0x00,0x02,0xCF};
		ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
		if (ret == DSIM_FALSE){
			printf("cmd_write error 0\n");
			//return ret;
		}
		mdelay(50);
		buf[0] = 0x2B;
		buf[3] = 0x03;
		buf[4] = 0xFF;
		ret = lcd_init_cmd_write(ddi_pd->dsim_base, DCS_LONG_WR,  buf, sizeof(buf));
		if (ret == DSIM_FALSE){
			printf("cmd_write error 1\n");
			//return ret;
		}
		mdelay(50);
#endif
	 	printf("cmmd_write 0x29\n");
		otm1280a_write_0(0x29);
		mdelay(4);
		//otm1280a_write_0(0x2C);
		//mdelay(50);
		otm1280a_write_1(0xFF, 0x00);
		mdelay(4);
		otm1280a_write_1(0x35, 0x00);
		mdelay(4);
	}

	return DSIM_TRUE;
}

void lcd_panel_init(void)
{
	lcd_pannel_on();
}

static int k3_panel_init(void)
{
	lcd_panel_init();

	return 0;
}

static int otm1280a_set_link(void *pd, unsigned int dsim_base,
		unsigned char (*cmd_write) (unsigned int dsim_base, unsigned int data0,
			unsigned int data1, unsigned int data2),
		unsigned char (*cmd_read) (unsigned int dsim_base, unsigned int data0,
			unsigned int data1, unsigned int data2))
{
	struct mipi_ddi_platform_data *temp_pd = NULL;

	temp_pd = (struct mipi_ddi_platform_data *) pd;
	if (temp_pd == NULL) {
		printk(KERN_ERR "mipi_ddi_platform_data is null.\n");
		temp_pd = malloc(sizeof(struct mipi_ddi_platform_data));
		//return -1;
	}

	ddi_pd = temp_pd;

	ddi_pd->dsim_base = dsim_base;

	if (cmd_write)
		ddi_pd->cmd_write = cmd_write;
	else
		printk(KERN_WARNING "cmd_write function is null.\n");

	if (cmd_read)
		ddi_pd->cmd_read = cmd_read;
	else
		printk(KERN_WARNING "cmd_read function is null.\n");

	return 0;
}

static int otm1280a_probe(struct device *dev)
{
	return 0;
}



struct mipi_lcd_driver otm1280a_mipi_driver = {
	.name = "k3_mipi_lcd",
	.pre_init = k3_get_panel_id,
	.init = k3_panel_init,
	.display_on = otm1280a_display_on,
	.set_link = otm1280a_set_link,
	.probe = otm1280a_probe,
	.display_off = otm1280a_display_off,
};


